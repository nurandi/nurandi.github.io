<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Web Scraping dengan R dan rvest | PaperMod</title>
<meta name="keywords" content="r, scraping, web scraping, rvest">
<meta name="description" content="Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan scientist, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam website yang diperuntukan untuk dibaca melalui browser? Beberapa website memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui API public), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu &ldquo;copy-paste&rdquo; data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak.">
<meta name="author" content="Nur Andi Setiabudi">
<link rel="canonical" href="/blog/web-scraping-dengan-r-dan-rvest/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.0c4fd3725171366f335155acde6fb3c7b7042cd2fd075bebf5023d9b28a701b2.css" integrity="sha256-DE/TclFxNm8zUVWs3m&#43;zx7cELNL9B1vr9QI9myinAbI=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/blog/web-scraping-dengan-r-dan-rvest/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Web Scraping dengan R dan rvest" />
<meta property="og:description" content="Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan scientist, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam website yang diperuntukan untuk dibaca melalui browser? Beberapa website memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui API public), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu &ldquo;copy-paste&rdquo; data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/web-scraping-dengan-r-dan-rvest/" /><meta property="og:image" content="/papermod-cover.png"/><meta property="article:section" content="blog" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/papermod-cover.png"/>

<meta name="twitter:title" content="Web Scraping dengan R dan rvest"/>
<meta name="twitter:description" content="Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan scientist, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam website yang diperuntukan untuk dibaca melalui browser? Beberapa website memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui API public), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu &ldquo;copy-paste&rdquo; data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "/blog/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Web Scraping dengan R dan rvest",
      "item": "/blog/web-scraping-dengan-r-dan-rvest/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Web Scraping dengan R dan rvest",
  "name": "Web Scraping dengan R dan rvest",
  "description": "Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan scientist, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam website yang diperuntukan untuk dibaca melalui browser? Beberapa website memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui API public), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu \u0026ldquo;copy-paste\u0026rdquo; data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak.",
  "keywords": [
    "r", "scraping", "web scraping", "rvest"
  ],
  "articleBody": "Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan scientist, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam website yang diperuntukan untuk dibaca melalui browser? Beberapa website memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui API public), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu “copy-paste” data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak. Web scraping adalah teknik yang lebih “smart” untuk otomatisasi proses copy-paste ini. Selain agar lebih efisien, tujuan utama dari web scraping sebenarnya adalah memanfaatkan struktur atau pola dari suatu laman web untuk mengekstrak dan menyimpan data dalam format yang diinginkan untuk dianalisis lebih lanjut.\nSecara teknis, ada beberapa pendekatan untuk melakukan web scraping, diantaranya:\nParsing HTML dari suatu laman web menggunakan CSS selector. Merupakan cara yang umum digunakan dan biasanya dapat dilakukan untuk banyak website. Schema JSON linked data dan JavaScript variable. XHR (XML HTTP Requests) Melalui artikel ini mari kita pelajari yang pertama: scraping dengan cara parsing HTML dari suatu laman HTML. Tools yang akan digunakan adalah R dengan package rvest. Agar lebih menarik, saya menggunakan contoh real berupa data top-scorers Liga Inggris dari halaman BBC Sport.\n{% include base_path %} {% capture fig_img %} ![BBC EPL Top Scorers]({{ base_path }}/img/blog/2019-11-05-web-scraping-dengan-r-dan-rvest/bbc-epl-top-scorers.png) {% endcapture %}\n{{ fig_img | markdownify | remove: \"\" | remove: \"\n\" }}\rTop Scorers Liga Inggris. Diakses dari [BBC Sport](https://www.bbc.com/sport/football/premier-league/top-scorers) pada 5 November 2019\rCatatan: Web scraping merupakan salah satu teknik yang sangat bermanfaat untuk mendapatkan data dari internet, tetapi dapat menyebabkan masalah bagi beberapa website. Untuk itu, proses web scraping harus dilakukan dengan penuh pertimbangan dan etika. Sebelum melakukan web scraping sebaiknya periksa dulu apakah website mempunyai file robots.txt? Jika iya, lihat apakah diizinkan untuk melakukan scraping pada halaman yang kita inginkan. File robots.txt dapat diakses di nama-domain/robots.txt, misalnya https://www.bbc.com/robots.txt.\nPackage rvest Package rvest ditulis oleh Hadley Wickham dari RStudio. Package ini mempunyai fungsi yang serupa dengan library beautiful soup pada Python, yaitu untuk web scraping. Langkah pertama, tentu saja, install dan load package rvest.\n{% highlight r %} install.packages(“rvest”) library(rvest) {% endhighlight %}\nInspect and scrape Proses scraping kita mulai dengan membaca file HTML dari halaman website dengan menggunakan fungsi read_html.\n{% highlight r %} url \u003c- “https://www.bbc.com/sport/football/premier-league/top-scorers\" html \u003c- read_html(url) {% endhighlight %}\nSelanjutnya, melalui browser kita identifikasi “letak” dari data yang akan kita ekstrak. Pada contoh ini, kita akan ekstrak list top scorers termasuk detailnya meliputi:\nplayer name team total goal scored minutes played minutes per goal total assists total shots on goal target total shots percentage on target Caranya, buka URL top-scorers melalui browser (misal pada contoh ini saya menggunakan Google Chrome). Klik kanan, klik Inspect lalu klik tab Element. Klik icon tanda panah di bagian kiri-atas, lalu arahkan kursor pada teks/element yang akan kita ekstrak. Sebagai contoh untuk mengekstrak nama pemain, bisa arahkan kursor pada salah satu nama pemain.\n{% capture fig_img %} ![Inspect element]({{ base_path }}/img/blog/2019-11-05-web-scraping-dengan-r-dan-rvest/inspect-element.png) {% endcapture %}\n{{ fig_img | markdownify | remove: \"\" | remove: \"\n\" }}\rInspect element pada Google Chrome. Dapat ditampilkan dengan cara klik kanan lalu klik *Inspect*\rSecara otomatis Chrome akan meng-highlight baris element HTML di mana teks itu berada, yaitu:\nSadio Mané Yang kita perlukan adalah CSS selectors atau XPath dari element tersebut. CSS selector biasanya ditandai dengan class, id, dan sebagainya (referensi). CSS selector untuk nama pemain adalah top-player-stats__name. Karena merupakan class, tambahkan titik sebelum huruf pertama, sehingga menjadi .top-player-stats__name.\nKembali ke R. Setelah mengetahui selector-nya, kita bisa mengekstrak informasi nama pemain dengan fungsi html_nodes (jika hanya satu pemain saja bisa menggunakan html_node) dan html_text untuk mengambil teksnya. Parameter trim = TRUE berguna untuk menghilangkan space sebelum/setelah teks.\n{% highlight r %} html %\u003e% html_nodes(\".top-player-stats__name”) %\u003e% html_text(trim = TRUE) {% endhighlight %}\nDengan cara seperti di atas, kita bisa mengekstrak nama team dengan selector .top-player-stats__team\n{% highlight r %} html %\u003e% html_nodes(\".top-player-stats__team\") %\u003e% html_text(trim = TRUE) {% endhighlight %}\nMembuat fungsi scraping Karena proses ekstraksi data merupakan pengulangan (dengan mengganti CSS selector), sangat disarankan untuk dibuat sebagai fungsi.\n{% highlight r %} scrape \u003c- function(selector, html){ html %\u003e% html_nodes(selector) %\u003e% html_text(trim = TRUE) } {% endhighlight %}\nSehingga untuk mendapatkan total goals scored cukup dengan perintah\n{% highlight r %} scrape(\".top-player-stats__goals-scored-number\", html) {% endhighlight %}\nSelanjutnya kita iterasi fungsi scrape untuk seluruh selector. Iterasi bisa menggunakan fungsi sapply/lapply.\n{% highlight r %} selector \u003c- c(\".top-player-stats__name\", “.top-player-stats__team”, “.top-player-stats__goals-scored-number”, “.top-player-stats__mins-played”, “.top-player-stats__mins-per-goal”, “.top-player-stats__assists”, “.shots-on-goal-total”, “.shots-total”, “.percentage-goals-on-target”)\ntop_scorers \u003c- sapply(selector, scrape, html) str(top_scorers) {% endhighlight %}\nClean up! Proses scraping sudah selesai dan hasilnya disimpan dalam matriks top-scorers. Matriks tersebut dapat kita ubah menjadi data frame dan beri nama yang tepat untuk setiap kolom.\n{% highlight r %} top_scorers \u003c- as.data.frame(top_scorers)\ncol_names \u003c- c(“name”, “team”, “total_goal”, “mins_played”, “mins_per_goal”, “assists”, “shots_on_goal”, “shots_total”, “percent_on_target”)\nnames(top_scorers) \u003c- col_names top_scorers {% endhighlight %}\nLast but not least… Tutorial ini hanya menggunakan tiga fungsi rvest. Tentu saja, ada fungsi-fungsi lain yang bisa digunakan sesuai keperluan, di antaranya:\nhtml_attr dan html_httrs : untuk ekstrak atribut, teks dan tag html_table : untuk parsing tabel HTML menjadi data frame html_form : parsing form Dan lain-lain. Sebagai catatan tambahan terkait dengan web scraping:\nScraping dengan rvest hanya bisa digunakan untuk web statis (artinya konten/data yang akan diekstrak berada dalam file HTML). Untuk web dinamis di mana data di-generate oleh JavaScript, misalnya, tidak cukup menggunakan rvest. Scraping hanya efektif apabila HTML terstruktur dengan baik. Bisa dibayangkan jika nama-nama pemain pada contoh di atas berada pada class yang berbeda? Jika tersedia, gunakan API (applicaton program interface) dan hindari scraping. Seperti telah saya sampaikan sebelumnya, lakukan scraping dengan penuh “etika”. Jangan sampai membebani website. Selamat menambang data! Semoga bermanfaat.\nPendekatan scraping lainnya akan kita pelajari pada artikel terpisah.\n",
  "wordCount" : "969",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Nur Andi Setiabudi"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/blog/web-scraping-dengan-r-dan-rvest/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "PaperMod",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="PaperMod (Alt + H)">PaperMod</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/fr/" title="French"
                            aria-label=":fr:">🇫🇷</a>
                    </li>
                    <li>
                        <a href="/fa/" title="Fa"
                            aria-label="Fa">Fa</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/search/" title="Search">
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://discord.gg/ahpmTvhVmp" title="Discord">
                    <span>Discord</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/blog/">Blogs</a></div>
    <h1 class="post-title">
      Web Scraping dengan R dan rvest
    </h1>
    <div class="post-meta">5 min&nbsp;·&nbsp;Nur Andi Setiabudi&nbsp;|&nbsp;<a href="https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content/blog/2019-11-05-web-scraping-dengan-r-dan-rvest/index.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#package-rvest" aria-label="Package rvest">Package rvest</a></li>
                <li>
                    <a href="#inspect-and-scrape" aria-label="Inspect and scrape">Inspect and scrape</a></li>
                <li>
                    <a href="#membuat-fungsi-scraping" aria-label="Membuat fungsi scraping">Membuat fungsi scraping</a></li>
                <li>
                    <a href="#last-but-not-least" aria-label="Last but not least&amp;hellip;">Last but not least&hellip;</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Di era digital sekarang ini, berbagai data dapat ditemukan dengan mudah di internet. Sebagai seorang data analis dan <em>scientist</em>, hal ini tentu menjadi kabar baik karena dapat meningkatkan kualitas model dan mempertajam hasil analisis. Tapi bagaimana jika data tersebut tersedia dalam <em>website</em> yang diperuntukan untuk dibaca melalui <em>browser</em>? Beberapa <em>website</em>  memang menyediakan fasilitas untuk menyimpan data (seperti Twitter melalui <em>API public</em>), tapi sayangnya sebagian besar tidak. Salah satu cara yang umum dilakukan adalah dengan membuka satu-per-satu halaman web lalu <em>&ldquo;copy-paste&rdquo;</em> data secara manual - tentunya akan menyita banyak waktu jika data sangat banyak. <em>Web scraping</em> adalah teknik yang lebih &ldquo;smart&rdquo; untuk otomatisasi proses <em>copy-paste</em> ini. Selain agar lebih efisien, tujuan utama dari <em>web scraping</em> sebenarnya adalah memanfaatkan struktur atau pola dari suatu laman web untuk mengekstrak dan menyimpan data dalam format yang diinginkan untuk dianalisis lebih lanjut.</p>
<p>Secara teknis, ada beberapa pendekatan untuk melakukan <em>web scraping</em>, diantaranya:</p>
<ol>
<li>Parsing HTML dari suatu laman web menggunakan <em>CSS selector</em>. Merupakan cara yang umum digunakan dan biasanya dapat dilakukan untuk banyak <em>website</em>.</li>
<li>Schema <em>JSON linked data</em> dan <em>JavaScript variable</em>.</li>
<li>XHR <em>(XML HTTP Requests)</em></li>
</ol>
<p>Melalui artikel ini mari kita pelajari yang pertama: <em>scraping</em> dengan cara parsing HTML dari suatu laman HTML. <em>Tools</em> yang akan digunakan adalah R dengan <em>package</em> <strong>rvest</strong>. Agar lebih menarik, saya menggunakan contoh <em>real</em> berupa data <em>top-scorers</em> Liga Inggris dari halaman <a href="https://www.bbc.com/sport/football/premier-league/top-scorers">BBC Sport</a>.</p>
<p>{% include base_path %}
{% capture fig_img %}
![BBC EPL Top Scorers]({{ base_path }}/img/blog/2019-11-05-web-scraping-dengan-r-dan-rvest/bbc-epl-top-scorers.png)
{% endcapture %}</p>
<figure>
{{ fig_img | markdownify | remove: "<p>" | remove: "</p>" }}
<span class="caption" markdown="1">Top Scorers Liga Inggris. Diakses dari [BBC Sport](https://www.bbc.com/sport/football/premier-league/top-scorers) pada 5 November 2019</span>
</figure> 
<p><strong>Catatan</strong>: <em>Web scraping</em> merupakan salah satu teknik yang sangat bermanfaat untuk mendapatkan data dari internet, tetapi dapat menyebabkan masalah bagi beberapa <em>website</em>. Untuk itu, proses <em>web scraping</em> harus dilakukan dengan penuh pertimbangan dan etika. Sebelum melakukan <em>web scraping</em> sebaiknya periksa dulu apakah website mempunyai file <strong>robots.txt</strong>? Jika iya, lihat apakah diizinkan untuk melakukan <em>scraping</em> pada halaman yang kita inginkan. File robots.txt dapat diakses di <strong>nama-domain/robots.txt</strong>, misalnya <a href="https://www.bbc.com/robots.txt">https://www.bbc.com/robots.txt</a>.</p>
<h1 id="package-rvest">Package rvest<a hidden class="anchor" aria-hidden="true" href="#package-rvest">#</a></h1>
<p><em>Package</em> <a href="https://rvest.tidyverse.org/"><strong>rvest</strong></a> ditulis oleh Hadley Wickham dari RStudio. <em>Package</em> ini mempunyai fungsi yang serupa dengan <em>library</em> <strong>beautiful soup</strong> pada Python, yaitu untuk <em>web scraping</em>. Langkah pertama, tentu saja, install dan <em>load package</em> <strong>rvest</strong>.</p>
<p>{% highlight r %}
install.packages(&ldquo;rvest&rdquo;)
library(rvest)
{% endhighlight %}</p>
<h1 id="inspect-and-scrape">Inspect and scrape<a hidden class="anchor" aria-hidden="true" href="#inspect-and-scrape">#</a></h1>
<p>Proses <em>scraping</em> kita mulai dengan membaca file HTML dari halaman website dengan menggunakan fungsi <code>read_html</code>.</p>
<p>{% highlight r %}
url &lt;- &ldquo;<a href="https://www.bbc.com/sport/football/premier-league/top-scorers%22">https://www.bbc.com/sport/football/premier-league/top-scorers&quot;</a>
html &lt;- read_html(url)
{% endhighlight %}</p>
<p>Selanjutnya, melalui browser kita identifikasi &ldquo;letak&rdquo; dari data yang akan kita ekstrak. Pada contoh ini, kita akan ekstrak list <em>top scorers</em> termasuk detailnya meliputi:</p>
<ul>
<li>player name</li>
<li>team</li>
<li>total goal scored</li>
<li>minutes played</li>
<li>minutes per goal</li>
<li>total assists</li>
<li>total shots on goal target</li>
<li>total shots</li>
<li>percentage on target</li>
</ul>
<p>Caranya, buka URL <em>top-scorers</em> melalui browser (misal pada contoh ini saya menggunakan Google Chrome). Klik kanan, klik <strong>Inspect</strong> lalu klik tab <strong>Element</strong>. Klik icon tanda panah di bagian kiri-atas, lalu arahkan kursor pada teks/element yang akan kita ekstrak. Sebagai contoh untuk mengekstrak nama pemain, bisa arahkan kursor pada salah satu nama pemain.</p>
<p>{% capture fig_img %}
![Inspect element]({{ base_path }}/img/blog/2019-11-05-web-scraping-dengan-r-dan-rvest/inspect-element.png)
{% endcapture %}</p>
<figure>
{{ fig_img | markdownify | remove: "<p>" | remove: "</p>" }}
<span class="caption" markdown="1">Inspect element pada Google Chrome. Dapat ditampilkan dengan cara klik kanan lalu klik *Inspect*</span>
</figure> 
<p>Secara otomatis Chrome akan meng-<em>highlight</em> baris <em>element</em> HTML di mana teks itu berada, yaitu:</p>
<pre tabindex="0"><code>&lt;h2 class=&#34;top-player-stats__name gel-double-pica&#34;&gt;Sadio Mané&lt;/h2&gt;
</code></pre><p>Yang kita perlukan adalah <em>CSS selectors</em> atau XPath dari <em>element</em> tersebut. <em>CSS selector</em> biasanya ditandai dengan <em>class</em>, <em>id</em>, dan sebagainya (<a href="https://www.w3schools.com/cssref/css_selectors.asp">referensi</a>). <em>CSS selector</em> untuk nama pemain adalah <code>top-player-stats__name</code>. Karena merupakan <em>class</em>, tambahkan titik sebelum huruf pertama, sehingga menjadi <code>.top-player-stats__name</code>.</p>
<p>Kembali ke R. Setelah mengetahui <em>selector</em>-nya, kita bisa mengekstrak informasi nama pemain dengan fungsi <code>html_nodes</code> (jika hanya satu pemain saja bisa menggunakan <code>html_node</code>) dan <code>html_text</code> untuk mengambil teksnya. Parameter <code>trim = TRUE</code> berguna untuk menghilangkan <em>space</em> sebelum/setelah teks.</p>
<p>{% highlight r %}
html %&gt;%
html_nodes(&quot;.top-player-stats__name&rdquo;) %&gt;%
html_text(trim = TRUE)
{% endhighlight %}</p>
<p>Dengan cara seperti di atas, kita bisa mengekstrak nama team dengan <em>selector</em> <code>.top-player-stats__team</code></p>
<p>{% highlight r %}
html %&gt;%
html_nodes(&quot;.top-player-stats__team&quot;) %&gt;%
html_text(trim = TRUE)
{% endhighlight %}</p>
<h1 id="membuat-fungsi-scraping">Membuat fungsi scraping<a hidden class="anchor" aria-hidden="true" href="#membuat-fungsi-scraping">#</a></h1>
<p>Karena proses ekstraksi data merupakan pengulangan (dengan mengganti <em>CSS selector</em>), sangat disarankan untuk dibuat sebagai fungsi.</p>
<p>{% highlight r %}
scrape &lt;- function(selector, html){
html %&gt;%
html_nodes(selector) %&gt;%
html_text(trim = TRUE)
}
{% endhighlight %}</p>
<p>Sehingga untuk mendapatkan <em>total goals scored</em> cukup dengan perintah</p>
<p>{% highlight r %}
scrape(&quot;.top-player-stats__goals-scored-number&quot;, html)
{% endhighlight %}</p>
<p>Selanjutnya kita iterasi fungsi <code>scrape</code> untuk seluruh <em>selector</em>. Iterasi bisa menggunakan fungsi <code>sapply</code>/<code>lapply</code>.</p>
<p>{% highlight r %}
selector &lt;- c(&quot;.top-player-stats__name&quot;,
&ldquo;.top-player-stats__team&rdquo;,
&ldquo;.top-player-stats__goals-scored-number&rdquo;,
&ldquo;.top-player-stats__mins-played&rdquo;,
&ldquo;.top-player-stats__mins-per-goal&rdquo;,
&ldquo;.top-player-stats__assists&rdquo;,
&ldquo;.shots-on-goal-total&rdquo;,
&ldquo;.shots-total&rdquo;,
&ldquo;.percentage-goals-on-target&rdquo;)</p>
<p>top_scorers &lt;- sapply(selector, scrape, html)
str(top_scorers)
{% endhighlight %}</p>
<p>Clean up! Proses <em>scraping</em> sudah selesai dan hasilnya disimpan dalam matriks <code>top-scorers</code>. Matriks tersebut dapat kita ubah menjadi <em>data frame</em> dan beri nama yang tepat untuk setiap kolom.</p>
<p>{% highlight r %}
top_scorers &lt;- as.data.frame(top_scorers)</p>
<p>col_names &lt;- c(&ldquo;name&rdquo;,
&ldquo;team&rdquo;,
&ldquo;total_goal&rdquo;,
&ldquo;mins_played&rdquo;,
&ldquo;mins_per_goal&rdquo;,
&ldquo;assists&rdquo;,
&ldquo;shots_on_goal&rdquo;,
&ldquo;shots_total&rdquo;,
&ldquo;percent_on_target&rdquo;)</p>
<p>names(top_scorers) &lt;- col_names
top_scorers
{% endhighlight %}</p>
<h1 id="last-but-not-least">Last but not least&hellip;<a hidden class="anchor" aria-hidden="true" href="#last-but-not-least">#</a></h1>
<p>Tutorial ini hanya menggunakan tiga fungsi <strong>rvest</strong>. Tentu saja, ada fungsi-fungsi lain yang bisa digunakan sesuai keperluan, di antaranya:</p>
<ul>
<li><code>html_attr</code> dan <code>html_httrs</code> : untuk ekstrak atribut, teks dan tag</li>
<li><code>html_table</code> : untuk parsing tabel HTML menjadi data frame</li>
<li><code>html_form</code> : parsing form</li>
<li>Dan lain-lain.</li>
</ul>
<p>Sebagai catatan tambahan terkait dengan <em>web scraping</em>:</p>
<ul>
<li><em>Scraping</em> dengan <strong>rvest</strong> hanya bisa digunakan untuk <em>web statis</em> (artinya konten/data yang akan diekstrak berada dalam file HTML). Untuk web dinamis di mana data di-<em>generate</em> oleh <strong>JavaScript</strong>, misalnya, tidak cukup menggunakan <strong>rvest</strong>.</li>
<li><em>Scraping</em> hanya efektif apabila HTML terstruktur dengan baik. Bisa dibayangkan jika nama-nama pemain pada contoh di atas berada pada class yang berbeda?</li>
<li>Jika tersedia, gunakan API <em>(applicaton program interface)</em> dan hindari <em>scraping</em>.</li>
<li>Seperti telah saya sampaikan sebelumnya, lakukan <em>scraping</em> dengan penuh &ldquo;etika&rdquo;. Jangan sampai membebani website.</li>
</ul>
<p>Selamat menambang data! Semoga bermanfaat.</p>
<p>Pendekatan <em>scraping</em> lainnya akan kita pelajari pada artikel terpisah.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/r/">R</a></li>
      <li><a href="/tags/scraping/">scraping</a></li>
      <li><a href="/tags/web-scraping/">web scraping</a></li>
      <li><a href="/tags/rvest/">rvest</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="/blog/visualisasi-rute-lari-dengan-r-dan-leaflet/">
    <span class="title">« Prev</span>
    <br>
    <span>Visualisasi Rute Lari dengan R dan Leaflet</span>
  </a>
  <a class="next" href="/blog/web-scraping-dengan-r-dan-rvest-parsing-tabel-html/">
    <span class="title">Next »</span>
    <br>
    <span>Web Scraping dengan R dan rvest: Parsing Tabel HTML</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on x"
        href="https://x.com/intent/tweet/?text=Web%20Scraping%20dengan%20R%20dan%20rvest&amp;url=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f&amp;hashtags=r%2cscraping%2cwebscraping%2crvest">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z"/>
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f&amp;title=Web%20Scraping%20dengan%20R%20dan%20rvest&amp;summary=Web%20Scraping%20dengan%20R%20dan%20rvest&amp;source=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on reddit"
        href="https://reddit.com/submit?url=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f&title=Web%20Scraping%20dengan%20R%20dan%20rvest">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on facebook"
        href="https://facebook.com/sharer/sharer.php?u=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on whatsapp"
        href="https://api.whatsapp.com/send?text=Web%20Scraping%20dengan%20R%20dan%20rvest%20-%20%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on telegram"
        href="https://telegram.me/share/url?text=Web%20Scraping%20dengan%20R%20dan%20rvest&amp;url=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Web Scraping dengan R dan rvest on ycombinator"
        href="https://news.ycombinator.com/submitlink?t=Web%20Scraping%20dengan%20R%20dan%20rvest&u=%2fblog%2fweb-scraping-dengan-r-dan-rvest%2f">
        <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
            <path
                d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="/">PaperMod</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
